ggplot(df_long, aes(x = Year, y = Value, color = Indicator, group = Indicator)) +
geom_line() +
facet_wrap(~ Country, scales = "free_y") + # Use 'scales = "free_y"' to allow each panel (country) to have its own y scale
theme_minimal() +
labs(title = "Evolution of Gini Index and Trade Unions Density by Country",
y = "Value",
x = "Year",
color = "Indicator") +
theme(legend.position = "bottom")
#######################################
# Create the plot with ggplot2
ggplot(df_long, aes(x = Year, y = Value, color = Indicator, group = interaction(Indicator, Country))) +
geom_line() +
facet_wrap(~ Country, scales = "free_y") + # Allows each country panel to have its own y scale
geom_vline(data = df_long %>% filter(!is.na(YearIntroduced)), aes(xintercept = YearIntroduced), linetype = "dashed", color = "red") +
theme_minimal() +
labs(title = "Evolution of Gini Index and Trade Unions Density by Country",
y = "Value",
x = "Year",
color = "Indicator") +
theme(legend.position = "bottom")
library(stargazer)
library(plm)
library(dplyr)
# Assuming 'df' is already loaded from an Excel file and ready to use
# Make sure 'Country' and 'Year' are factors for panel data analyses
df <- df %>%
mutate(
Country = as.factor(Country),
Year = as.factor(Year)
)
# Convert the data frame to a pdata.frame for plm (panel data operations)
pdata <- pdata.frame(df, index = c("Country", "Year"))
model_formulas <- c(
"Gini_Index ~ TradeUnions_Density + bargain1 + Inflation + WageGrowth + lnminwage",
"Gini_Index ~ TradeUnions_Density + bargain1 + Inflation + WageGrowth + lnminwage + CollectiveBargain_Coverage",
"Gini_Index ~ TradeUnions_Density + bargain1 + Inflation + WageGrowth + lnminwage + CollectiveBargain_Coverage + lnGDP + Gov_debt",
"Gini_Index ~ TradeUnions_Density + bargain1 + Inflation + WageGrowth + lnminwage + CollectiveBargain_Coverage + lnGDP + Gov_debt + ln_labor + Female_Workers + Parttime_employment + WomenUnemployment_rate",
"Gini_Index ~ TradeUnions_Density + bargain1 + Inflation + WageGrowth + lnminwage + CollectiveBargain_Coverage + lnGDP + Gov_debt + ln_labor + Female_Workers + Parttime_employment + WomenUnemployment_rate + Exports_growth + Imports_growth",
"Gini_Index ~ TradeUnions_Density + bargain1 + Inflation + WageGrowth + lnminwage + CollectiveBargain_Coverage + lnGDP + Gov_debt + ln_labor + Female_Workers + Parttime_employment + WomenUnemployment_rate + Exports_growth + Imports_growth + FDI_inflow + FDI_outflow + Tax_contribution"
)
# Function to create models of a specific type
create_models <- function(data, type, formulas) {
lapply(formulas, function(formula) {
formula <- as.formula(formula)
if (type == "OLS") {
return(lm(formula, data = data))
} else if (type == "FE") {
return(plm(formula, data = data, model = "within"))
} else if (type == "FD") {
return(plm(formula, data = data, model = "fd"))
} else {
stop("Unknown model type")
}
})
}
# Create OLS, FE, and FD models
ols_models <- create_models(df, "OLS", model_formulas)
fe_models <- create_models(pdata, "FE", model_formulas)
fd_models <- create_models(pdata, "FD", model_formulas)
# Summarize the models
stargazer(ols_models, type = "text", title = "OLS Regression Models")
stargazer(fe_models, type = "text", title = "Fixed Effects Regression Models")
stargazer(fd_models, type = "text", title = "First Differences Regression Models")
##### BUILDING WITH IV. THE DATA ARE GATHERED FROM THE WEBSITE "https://ourworldindata.org/grapher/civil-society-participation-index" and "https://ourworldindata.org/grapher/rule-of-law-index?tab=chart&time=1990..latest"
# IN THIS CASE WE USE INTERACTION BETWEEN ROL AND CIVIC PARTICIPATION AS IV.
library(plm)
library(AER)
library(dplyr)
library(readr)
# WE ASSUME THAT CIVIC PARTICIPATION IS EXOGENOUS TO GINI INDEX
rol <- read_csv("/Users/jacopobinati/Desktop/thesis/Datasets/rule-of-law-index.csv")
part <- read_csv("/Users/jacopobinati/Desktop/thesis/Datasets/civil-society-participation-index.csv")
# Specify countries to keep
countries_to_keep <- c('Austria', 'Belgium', 'Czechia', 'Denmark', 'Estonia', 'Finland',
'France', 'Germany', 'Greece', 'Hungary', 'Iceland', 'Ireland',
'Italy', 'Lithuania', 'Luxemburg', 'Netherlands', 'Norway', 'Poland',
'Portugal', 'Slovak Republic', 'Spain', 'Sweden', 'Switzerland',
'United Kingdom')
# Filter rol and part data
rol <- rol %>%
filter(Year >= 1990, Entity %in% countries_to_keep)
part <- part %>%
filter(Year >= 1990, Entity %in% countries_to_keep)
# Drop columns
columns_to_drop1 <- c('civsoc_particip_vdem_low_owid', 'civsoc_particip_vdem_high_owid')
columns_to_drop2 <- c('rule_of_law_vdem_low_owid', 'rule_of_law_vdem_high_owid')
rol <- select(rol, -one_of(columns_to_drop2))
part <- select(part, -one_of(columns_to_drop1))
# Rename columns
rol <- rename(rol, rol = rule_of_law_vdem_owid, Country = Entity)
part <- rename(part, civsoc_particip = civsoc_particip_vdem_owid, Country = Entity)
# Assuming 'df' is your main dataframe and it has 'Country' and 'Year' columns
df <- merge(df, rol, by = c("Country", "Year"), all.x = TRUE)
df <- merge(df, part, by = c("Country", "Year"), all.x = TRUE)
# Drop unnecessary columns
dropdf <- c('Code.x', 'Code.y')
df <- select(df, -one_of(dropdf))
# Create a new column 'demo'
df$demo <- df$civsoc_particip * df$rol
# create a copy of df and call it dataset
dataset <- df
# Check for missing values in the dataset
missing_values <- is.na(dataset)
missing_values_summary <- colSums(missing_values)
print(missing_values_summary)
dataset <- dataset %>%
filter(!Country %in% c("Slovak Republic", "Luxembourg"))
####### BUILDING THE MODELS
# Ensure 'Year' and 'Country' are correctly formatted
dataset$Year <- as.integer(dataset$Year)
dataset$Country <- as.factor(dataset$Country)
##########################################################
# Sum of NA values in each column
na_count <- sapply(dataset, function(x) sum(is.na(x)))
print(na_count)
# Sum of infinite values in each column
inf_count <- sapply(dataset, function(x) sum(is.infinite(x)))
print(inf_count)
# Combined check for any NA or infinite values across the entire dataset
total_issues <- sum(na_count + inf_count)
print(total_issues)
##########################################################
library(lfe)
library(lmtest)
first_stage <- lm(bargain1 ~ demo + CollectiveBargain_Coverage + Inflation + WageGrowth + Gov_debt + ln_labor + WomenUnemployment_rate, data = dataset)
summary(first_stage)
dataset$bargain1_fitted <- predict(first_stage, newdata = dataset)
# Perform the second stage of the IV regression
second_stage <- lm(Gini_Index ~ bargain1_fitted + CollectiveBargain_Coverage + Inflation + WageGrowth + Gov_debt + ln_labor + WomenUnemployment_rate, data = dataset)
# Display the summary of the second-stage regression
summary(second_stage)
## IV REGRESSION
library(AER)
# Define the model formulas
model1_formula <- ivreg(Gini_Index ~ TradeUnions_Density + Inflation + WageGrowth + lnminwage + CollectiveBargain_Coverage + lnGDP + Gov_debt + ln_labor + Female_Workers + Parttime_employment + WomenUnemployment_rate | TradeUnions_Density + demo + Inflation + WageGrowth + lnminwage + CollectiveBargain_Coverage + lnGDP + Gov_debt + ln_labor + Female_Workers + Parttime_employment + WomenUnemployment_rate, data = dataset)
model2_formula <- ivreg(Gini_Index ~ TradeUnions_Density + Inflation + WageGrowth + lnminwage + CollectiveBargain_Coverage + lnGDP + Gov_debt + ln_labor + Female_Workers + Parttime_employment + WomenUnemployment_rate + Exports_growth + Imports_growth | TradeUnions_Density + demo + Inflation + WageGrowth + lnminwage + CollectiveBargain_Coverage + lnGDP + Gov_debt + ln_labor + Female_Workers + Parttime_employment + WomenUnemployment_rate + Exports_growth + Imports_growth, data = dataset)
model3_formula <- ivreg(Gini_Index ~ TradeUnions_Density + Inflation + WageGrowth + lnminwage + CollectiveBargain_Coverage + lnGDP + Gov_debt + ln_labor + Female_Workers + Parttime_employment + WomenUnemployment_rate + Exports_growth + Imports_growth + FDI_inflow + FDI_outflow + Tax_contribution | TradeUnions_Density + demo + Inflation + WageGrowth + lnminwage + CollectiveBargain_Coverage + lnGDP + Gov_debt + ln_labor + Female_Workers + Parttime_employment + WomenUnemployment_rate + Exports_growth + Imports_growth + FDI_inflow + FDI_outflow + Tax_contribution, data = dataset)
# Estimate the models
model1 <- summary(model1_formula)
model2 <- summary(model2_formula)
model3 <- summary(model3_formula)
# Display the summaries
print(model1)
print(model2)
print(model3)
stargazer(model1_formula, model2_formula, model3_formula, type="text")
model1 <- summary(model1_formula)
model2 <- summary(model2_formula)
model3 <- summary(model3_formula)
model1_formula <- ivreg(Gini_Index ~ TradeUnions_Density + Inflation + WageGrowth + lnminwage + CollectiveBargain_Coverage + lnGDP + Gov_debt + ln_labor + Female_Workers + Parttime_employment + WomenUnemployment_rate | TradeUnions_Density + demo + Inflation + WageGrowth + lnminwage + CollectiveBargain_Coverage + lnGDP + Gov_debt + ln_labor + Female_Workers + Parttime_employment + WomenUnemployment_rate, data = dataset)
model2_formula <- ivreg(Gini_Index ~ TradeUnions_Density + Inflation + WageGrowth + lnminwage + CollectiveBargain_Coverage + lnGDP + Gov_debt + ln_labor + Female_Workers + Parttime_employment + WomenUnemployment_rate + Exports_growth + Imports_growth | TradeUnions_Density + demo + Inflation + WageGrowth + lnminwage + CollectiveBargain_Coverage + lnGDP + Gov_debt + ln_labor + Female_Workers + Parttime_employment + WomenUnemployment_rate + Exports_growth + Imports_growth, data = dataset)
model3_formula <- ivreg(Gini_Index ~ TradeUnions_Density + Inflation + WageGrowth + lnminwage + CollectiveBargain_Coverage + lnGDP + Gov_debt + ln_labor + Female_Workers + Parttime_employment + WomenUnemployment_rate + Exports_growth + Imports_growth + FDI_inflow + FDI_outflow + Tax_contribution | TradeUnions_Density + demo + Inflation + WageGrowth + lnminwage + CollectiveBargain_Coverage + lnGDP + Gov_debt + ln_labor + Female_Workers + Parttime_employment + WomenUnemployment_rate + Exports_growth + Imports_growth + FDI_inflow + FDI_outflow + Tax_contribution, data = dataset)
stargazer(model1_formula, model2_formula, model3_formula, type="text")
stargazer(fe_models[4,5,6], type = "text", title = "Fixed Effects Regression Models")
stargazer(fe_models(c[4,5,6]), type = "text", title = "Fixed Effects Regression Models")
stargazer(fe_models[c(4, 5, 6)], type = "text", title = "Fixed Effects Regression Models")
dev.off()
dev off()
# Load required library
library(igraph)
# Define the nodes with categories
nodes_with_categories <- data.frame(
name = c('Collective Bargain Coverage', 'Trade Unions Density', 'Gini Index',
'Real Average Annual Wage Growth', 'Annual Inflation CPI',
'Exports of goods and services (annual % growth)',
'Foreign direct investment, net inflows (% of GDP)',
'Foreign direct investment, net outflows (% of GDP)',
'Imports of goods and services (% of GDP)',
'Current health expenditure (% of GDP)',
'Central government debt, total (% of GDP)',
'GDP (current US$)',
'Labour force participation rate (Women age 15 to 64)',
'Unemployment rate (Women age 15 to 64)', 'Labor force, total',
'Labor tax and contributions (% of commercial profits)',
'Part time employment, total (% of total employment)', 'Monthly Minimum Wage'),
category = c(rep('Collective Bargaining', 2), 'Income Inequality', rep('Economic', 11),
rep('Labor Market', 4))
)
# Define the edges
edges <- matrix(c('Trade Unions Density', 'Gini Index',
'Collective Bargain Coverage', 'Trade Unions Density',
'Real Average Annual Wage Growth', 'Trade Unions Density',
'Annual Inflation CPI', 'Real Average Annual Wage Growth',
'Annual Inflation CPI', 'Labor tax and contributions (% of commercial profits)',
'Labor tax and contributions (% of commercial profits)', 'GDP (current US$)',
'Labor tax and contributions (% of commercial profits)', 'Labor force, total',
'Part time employment, total (% of total employment)', 'Labor force, total',
'Labour force participation rate (Women age 15 to 64)', 'Labor force, total',
'Unemployment rate (Women age 15 to 64)', 'Labor force, total',
'Labor force, total', 'Real Average Annual Wage Growth',
'Labor force, total', 'Annual Inflation CPI',
'Labor force, total', 'Collective Bargain Coverage',
'Labor force, total', 'GDP (current US$)',
'GDP (current US$)', 'Real Average Annual Wage Growth',
'Exports of goods and services (annual % growth)', 'GDP (current US$)',
'Foreign direct investment, net inflows (% of GDP)', 'GDP (current US$)',
'Foreign direct investment, net outflows (% of GDP)', 'GDP (current US$)',
'Imports of goods and services (% of GDP)', 'GDP (current US$)'),
byrow = TRUE, ncol = 2)
# Create the graph
G <- graph_from_edgelist(edges, directed = TRUE)
# Add node attributes
V(G)$category <- nodes_with_categories$category[match(V(G)$name, nodes_with_categories$name)]
# Plotting
plot(G, vertex.size=20, vertex.label=V(G)$name, vertex.color="lightblue",
main="Causal Map: Collective Bargaining and Income Inequality",
edge.arrow.size=.5, vertex.label.cex=0.8, vertex.label.family="sans",
layout=layout_nicely(G))
# Load required library
library(igraph)
# Define the nodes with categories
nodes_with_categories <- data.frame(
name = c('Collective Bargain Coverage', 'Trade Unions Density', 'Gini Index',
'Real Average Annual Wage Growth', 'Annual Inflation CPI',
'Exports of goods and services (annual % growth)',
'Foreign direct investment, net inflows (% of GDP)',
'Foreign direct investment, net outflows (% of GDP)',
'Imports of goods and services (% of GDP)',
'Current health expenditure (% of GDP)',
'Central government debt, total (% of GDP)',
'GDP (current US$)',
'Labour force participation rate (Women age 15 to 64)',
'Unemployment rate (Women age 15 to 64)', 'Labor force, total',
'Labor tax and contributions (% of commercial profits)',
'Part time employment, total (% of total employment)', 'Monthly Minimum Wage'),
category = c(rep('Collective Bargaining', 2), 'Income Inequality', rep('Economic', 11),
rep('Labor Market', 4))
)
# Define the edges
edges <- matrix(c('Trade Unions Density', 'Gini Index',
'Collective Bargain Coverage', 'Trade Unions Density',
'Real Average Annual Wage Growth', 'Trade Unions Density',
'Annual Inflation CPI', 'Real Average Annual Wage Growth',
'Annual Inflation CPI', 'Labor tax and contributions (% of commercial profits)',
'Labor tax and contributions (% of commercial profits)', 'GDP (current US$)',
'Labor tax and contributions (% of commercial profits)', 'Labor force, total',
'Part time employment, total (% of total employment)', 'Labor force, total',
'Labour force participation rate (Women age 15 to 64)', 'Labor force, total',
'Unemployment rate (Women age 15 to 64)', 'Labor force, total',
'Labor force, total', 'Real Average Annual Wage Growth',
'Labor force, total', 'Annual Inflation CPI',
'Labor force, total', 'Collective Bargain Coverage',
'Labor force, total', 'GDP (current US$)',
'GDP (current US$)', 'Real Average Annual Wage Growth',
'Exports of goods and services (annual % growth)', 'GDP (current US$)',
'Foreign direct investment, net inflows (% of GDP)', 'GDP (current US$)',
'Foreign direct investment, net outflows (% of GDP)', 'GDP (current US$)',
'Imports of goods and services (% of GDP)', 'GDP (current US$)'),
byrow = TRUE, ncol = 2)
# Create the graph
G <- graph_from_edgelist(edges, directed = TRUE)
# Add node attributes
V(G)$category <- nodes_with_categories$category[match(V(G)$name, nodes_with_categories$name)]
# Plotting
plot(G, vertex.size=20, vertex.label=V(G)$name, vertex.color="lightblue",
main="Causal Map: Collective Bargaining and Income Inequality",
edge.arrow.size=.8, vertex.label.cex=0.8, vertex.label.family="sans",
layout=layout_nicely(G))
plot(G, vertex.size=20, vertex.label=V(G)$name, vertex.color="lightblue",
main="Causal Map: Collective Bargaining and Income Inequality",
edge.arrow.size=.8, vertex.label.cex=0.5, vertex.label.family="sans",
layout=layout_nicely(G))
library(igraph)
# Define the nodes with categories
nodes_with_categories <- data.frame(
name = c('Collective Bargain Coverage', 'Trade Unions Density', 'Gini Index',
'Real Wage Growth', 'Annual Inflation',
'Exports of goods and services',
'Foreign direct investment, net inflows',
'Foreign direct investment, net outflows',
'Imports of goods and services',
'Current health expenditure',
'Central government debt',
'GDP',
'Labour force participation rate',
'Unemployment rate', 'Labor force, total',
'Labor tax and contributions',
'Part time employment, total', 'Monthly Minimum Wage'),
category = c(rep('Collective Bargaining', 2), 'Income Inequality', rep('Economic', 11),
rep('Labor Market', 4))
)
# Define the edges
edges <- matrix(c('Trade Unions Density', 'Gini Index',
'Collective Bargain Coverage', 'Trade Unions Density',
'Real Wage Growth', 'Trade Unions Density',
'Annual Inflation', 'Real Wage Growth',
'Annual Inflation', 'Labor tax and contributions',
'Labor tax and contributions', 'GDP',
'Labor tax and contributions', 'Labor force',
'Part time employment', 'Labor force',
'Labour force participation rate', 'Labor force',
'Unemployment rate', 'Labor force',
'Labor force', 'Real Wage Growth',
'Labor force', 'Annual Inflation CPI',
'Labor force', 'Collective Bargain Coverage',
'Labor force', 'GDP',
'GDP', 'Real Wage Growth',
'Exports of goods and services', 'GDP',
'Foreign direct investment, net inflows', 'GDP',
'Foreign direct investment, net outflows', 'GDP',
'Imports of goods and services', 'GDP'),
byrow = TRUE, ncol = 2)
# Create the graph
G <- graph_from_edgelist(edges, directed = TRUE)
# Add node attributes
V(G)$category <- nodes_with_categories$category[match(V(G)$name, nodes_with_categories$name)]
# Plotting
plot(G, vertex.size=20, vertex.label=V(G)$name, vertex.color="lightblue",
main="Causal Map: Collective Bargaining and Income Inequality",
edge.arrow.size=.8, vertex.label.cex=0.5, vertex.label.family="sans",
layout=layout_nicely(G))
plot(G, vertex.size=30, vertex.label=V(G)$name, vertex.color="lightblue",
main="Causal Map: Collective Bargaining and Income Inequality",
edge.arrow.size=.8, vertex.label.cex=0.5, vertex.label.family="sans",
layout=layout_nicely(G))
plot(G, vertex.size=25, vertex.label=V(G)$name, vertex.color="lightblue",
main="Causal Map: Collective Bargaining and Income Inequality",
edge.arrow.size=.8, vertex.label.cex=0.5, vertex.label.family="sans",
layout=layout_nicely(G))
plot(G, vertex.size=25, vertex.label=V(G)$name, vertex.color="lightblue",
main="Causal Map: Collective Bargaining and Income Inequality",
edge.arrow.size=.8, vertex.label.cex=0.5, vertex.label.family="sans",
layout=layout_with_fr(G, area=vcount(G)^2, repulserad=vcount(G)^2))
plot(G, vertex.size=25, vertex.label=V(G)$name, vertex.color="lightblue",
main="Causal Map: Collective Bargaining and Income Inequality",
edge.arrow.size=.8, vertex.label.cex=0.5, vertex.label.family="sans",
layout=layout_with_fr(G, area=vcount(G)^2, repulserad=vcount(G)^3))
plot(G, vertex.size=25, vertex.label=V(G)$name, vertex.color="lightblue",
main="Causal Map: Collective Bargaining and Income Inequality",
edge.arrow.size=.8, vertex.label.cex=0.5, vertex.label.family="sans",
layout=layout_with_fr(G, area=vcount(G)^2, repulserad=vcount(G)^4))
# Define the edges
edges <- matrix(c('Trade Unions Density', 'Gini Index',
'Collective Bargain Coverage', 'Trade Unions Density',
'Real Wage Growth', 'Trade Unions Density',
'Annual Inflation', 'Real Wage Growth',
'Annual Inflation', 'Labor tax and contributions',
'Labor tax and contributions', 'GDP',
'Labor tax and contributions', 'Labor force',
'Part time employment', 'Labor force',
'Labour force participation rate', 'Labor force',
'Unemployment rate', 'Labor force',
'Labor force', 'Real Wage Growth',
'Labor force', 'Annual Inflation',
'Labor force', 'Collective Bargain Coverage',
'Labor force', 'GDP',
'GDP', 'Real Wage Growth',
'Exports of goods and services', 'GDP',
'Foreign direct investment, net inflows', 'GDP',
'Foreign direct investment, net outflows', 'GDP',
'Imports of goods and services', 'GDP'),
byrow = TRUE, ncol = 2)
# Create the graph
G <- graph_from_edgelist(edges, directed = TRUE)
# Add node attributes
V(G)$category <- nodes_with_categories$category[match(V(G)$name, nodes_with_categories$name)]
# Plotting
plot(G, vertex.size=25, vertex.label=V(G)$name, vertex.color="lightblue",
main="Causal Map: Collective Bargaining and Income Inequality",
edge.arrow.size=.8, vertex.label.cex=0.5, vertex.label.family="sans",
layout=layout_with_fr(G, area=vcount(G)^2, repulserad=vcount(G)^4))
plot(G, vertex.size=25, vertex.label=V(G)$name, vertex.color="lightblue",
main="Causal Map: Collective Bargaining and Income Inequality",
edge.arrow.size=.8, vertex.label.cex=0.5, vertex.label.family="sans",
layout=layout_with_fr(G, area=vcount(G)^3, repulserad=vcount(G)^10))
plot(G, vertex.size=25, vertex.label=V(G)$name, vertex.color="lightblue",
main="Causal Map: Collective Bargaining and Income Inequality",
edge.arrow.size=.8, vertex.label.cex=0.5, vertex.label.family="sans",
layout=layout_with_fr(G, area=vcount(G)^3, repulserad=vcount(G)^20))
plot(G, vertex.size=25, vertex.label=V(G)$name, vertex.color="lightblue",
main="Causal Map: Collective Bargaining and Income Inequality",
edge.arrow.size=.8, vertex.label.cex=0.5, vertex.label.family="sans",
layout=layout_with_fr(G, area=vcount(G)^4, repulserad=vcount(G)^20))
# Plotting
plot(G, vertex.size=25, vertex.label=V(G)$name, vertex.color="lightblue",
main="Causal Map: Labour Unions and Income Inequality",
edge.arrow.size=.8, vertex.label.cex=0.5, vertex.label.family="times",
layout=layout_with_fr(G, area=vcount(G)^4, repulserad=vcount(G)^20))
plot(G, vertex.size=25, vertex.label=V(G)$name, vertex.color="lightblue",
main="Causal Map: Labour Unions and Income Inequality",
edge.arrow.size=.8, vertex.label.cex=0.5, vertex.label.family="Times",
layout=layout_with_fr(G, area=vcount(G)^4, repulserad=vcount(G)^20))
# Plotting
plot(G, vertex.size=25, vertex.label=V(G)$name, vertex.color="lightblue",
main="Causal Map: Labour Unions and Income Inequality",
edge.arrow.size=.8, vertex.label.cex=0.5, vertex.label.family="Times",
layout=layout_with_fr(G, area=vcount(G)^4, repulserad=vcount(G)^4))
# Plotting
plot(G, vertex.size=25, vertex.label=V(G)$name, vertex.color="lightblue",
main="Causal Map: Labour Unions and Income Inequality",
edge.arrow.size=.8, vertex.label.cex=0.5, vertex.label.family="Times",
layout=layout_with_fr(G, area=vcount(G)^4, repulserad=vcount(G)^4))
# Plotting
plot(G, vertex.size=25, vertex.label=V(G)$name, vertex.color="lightblue",
main="Causal Map: Labour Unions and Income Inequality",
edge.arrow.size=.8, vertex.label.cex=0.5, vertex.label.family="Times",
layout=layout_with_fr(G, area=vcount(G)^4, repulserad=vcount(G)^4))
# Plotting
plot(G, vertex.size=25, vertex.label=V(G)$name, vertex.color="lightblue",
main="Causal Map: Labour Unions and Income Inequality",
edge.arrow.size=.8, vertex.label.cex=0.5, vertex.label.family="Times",
layout=layout_with_fr(G, area=vcount(G)^4, repulserad=vcount(G)^4))
# Plotting
plot(G, vertex.size=25, vertex.label=V(G)$name, vertex.color="lightblue",
main="Causal Map: Labour Unions and Income Inequality",
edge.arrow.size=.8, vertex.label.cex=0.5, vertex.label.family="Times",
layout=layout_with_fr(G, area=vcount(G)^4, repulserad=vcount(G)^4))
# Plotting
plot(G, vertex.size=25, vertex.label=V(G)$name, vertex.color="lightblue",
main="Causal Map: Labour Unions and Income Inequality",
edge.arrow.size=.8, vertex.label.cex=0.5, vertex.label.family="Times",
layout=layout_with_fr(G, area=vcount(G)^4, repulserad=vcount(G)^4))
plot(G, vertex.size=25, vertex.label=V(G)$name, vertex.color="lightblue",
main="Causal Map: Labour Unions and Income Inequality",
edge.arrow.size=.8, vertex.label.cex=0.5, vertex.label.family="Times",
layout=layout_with_graphopt(G, charge=1000, mass=1, spring.length=0, spring.constant=1))
plot(G, vertex.size=25, vertex.label=V(G)$name, vertex.color="lightblue",
main="Causal Map: Labour Unions and Income Inequality",
edge.arrow.size=.8, vertex.label.cex=0.5, vertex.label.family="Times",
layout=layout_with_graphopt(G, charge=1000, mass=1, spring.length=0, spring.constant=1))
plot(G, vertex.size=25, vertex.label=V(G)$name, vertex.color="lightblue",
main="Causal Map: Labour Unions and Income Inequality",
edge.arrow.size=.8, vertex.label.cex=0.5, vertex.label.family="Times",
layout=layout_with_graphopt(G, charge=1000, mass=1, spring.length=0, spring.constant=1))
plot(G, vertex.size=25, vertex.label=V(G)$name, vertex.color="lightblue",
main="Causal Map: Labour Unions and Income Inequality",
edge.arrow.size=.8, vertex.label.cex=0.5, vertex.label.family="Times",
layout=layout_with_graphopt(G, charge=1000, mass=1, spring.length=0, spring.constant=1))
plot(G, vertex.size=25, vertex.label=V(G)$name, vertex.color="lightblue",
main="Causal Map: Labour Unions and Income Inequality",
edge.arrow.size=.8, vertex.label.cex=0.5, vertex.label.family="Times",
layout=layout_with_graphopt(G, charge=1000, mass=1, spring.length=0, spring.constant=1))
plot(G, vertex.size=25, vertex.label=V(G)$name, vertex.color="lightblue",
main="Causal Map: Labour Unions and Income Inequality",
edge.arrow.size=.8, vertex.label.cex=0.5, vertex.label.family="Times",
layout=layout_with_graphopt(G, charge=1000, mass=1, spring.length=0, spring.constant=1))
plot(G, vertex.size=25, vertex.label=V(G)$name, vertex.color="lightblue",
main="Causal Map: Labour Unions and Income Inequality",
edge.arrow.size=.8, vertex.label.cex=0.5, vertex.label.family="Times",
layout=layout_with_dh(G))
plot(G, vertex.size=25, vertex.label=V(G)$name, vertex.color="lightblue",
main="Causal Map: Labour Unions and Income Inequality",
edge.arrow.size=.8, vertex.label.cex=0.5, vertex.label.family="Times",
layout=layout_with_fr(G, area=vcount(G)^4, repulserad=vcount(G)^4))
plot(G, vertex.size=25, vertex.label=V(G)$name, vertex.color="lightblue",
main="Causal Map: Labour Unions and Income Inequality",
edge.arrow.size=.8, vertex.label.cex=0.5, vertex.label.family="Times",
layout=layout_with_fr(G, area=vcount(G)^3, repulserad=vcount(G)^3))
plot(G, vertex.size=25, vertex.label=V(G)$name, vertex.color="lightblue",
main="Causal Map: Labour Unions and Income Inequality",
edge.arrow.size=.8, vertex.label.cex=0.5, vertex.label.family="Times",
layout=layout_with_fr(G, area=vcount(G)^3, repulserad=vcount(G)^3))
plot(G, vertex.size=25, vertex.label=V(G)$name, vertex.color="lightblue",
main="Causal Map: Labour Unions and Income Inequality",
edge.arrow.size=.8, vertex.label.cex=0.5, vertex.label.family="Times",
layout=layout_with_fr(G, area=vcount(G)^3, repulserad=vcount(G)^3))
plot(G, vertex.size=25, vertex.label=V(G)$name, vertex.color="lightblue",
main="Causal Map: Labour Unions and Income Inequality",
edge.arrow.size=.8, vertex.label.cex=0.5, vertex.label.family="Times",
layout=layout_with_fr(G, area=vcount(G)^3, repulserad=vcount(G)^3))
nodes_with_categories <- list(
'Trade Unions Density' = 'Collective Bargaining',
'Gini Index' = 'Income Inequality'
)
edges <- matrix(c(
'Trade Unions Density', 'Gini Index'
), byrow=TRUE, ncol=2)
# Create the graph P
P <- graph_from_edgelist(edges, directed=TRUE)
layout <- layout_with_fr(P)
png("density_to_income_inequality.png", width=800, height=600, res=150)
plot(P,
layout=layout,
vertex.size=20,
vertex.label.cex=.8,
edge.arrow.size=0.5,
main="Density to Income Inequality Relationship")
edges <- matrix(
c('Trade Unions Density', 'Gini Index',
'Confounders', 'Trade Unions Density',
'Confounders', 'Gini Index'),
ncol = 2, byrow = TRUE
)
# Create the graph
P <- graph_from_edgelist(edges, directed = TRUE)
# Define the layout
# Note: igraph does not have a shell layout, but you can use a circular layout as a simple alternative
layout <- layout_in_circle(P)
# Plot the graph
plot(P, layout = layout, vertex.size=20, vertex.label=V(P)$name, vertex.color='skyblue',
edge.arrow.size=1, main="Causal Map", vertex.label.cex=1, vertex.label.family="sans",
margin=-0.1)
title(main="Causal Map", font.main=2, cex.main=1.5)
# Plot the graph
plot(P, layout = layout, vertex.size=20, vertex.label=V(P)$name, vertex.color='skyblue',
edge.arrow.size=1, main="Causal Map", vertex.label.cex=1, vertex.label.family="sans",
margin=-0)
title(main="Causal Map", font.main=2, cex.main=1.5)
plot(P, layout = layout, vertex.size=20, vertex.label=V(P)$name, vertex.color='skyblue',
edge.arrow.size=1, main="Causal Map", vertex.label.cex=1, vertex.label.family="Times",
margin=-0)
title(main="Causal Map", font.main=2, cex.main=1.5)
# Plot the graph
plot(P, layout = layout, vertex.size=20, vertex.label=V(P)$name, vertex.color='skyblue',
edge.arrow.size=1, main="Causal Map", font.main=2, cex.main=1.5,
vertex.label.cex=1, vertex.label.family="Times",
margin=-0)
plot(P, layout = layout, vertex.size=20, vertex.label=V(P)$name, vertex.color='skyblue',
edge.arrow.size=1, main="Causal Map", font.main=2, cex.main=1.5,
vertex.label.cex=1, vertex.label.family="Times", vertex.label.color="black",
margin=-0)
